# Adversarial-Swarm (HIVE-ZERO)

[![Python CI](https://github.com/DonHin-00/Adversarial-Swarm/actions/workflows/python-ci.yml/badge.svg)](https://github.com/DonHin-00/Adversarial-Swarm/actions/workflows/python-ci.yml)
[![Security Scan](https://github.com/DonHin-00/Adversarial-Swarm/actions/workflows/security-scan.yml/badge.svg)](https://github.com/DonHin-00/Adversarial-Swarm/actions/workflows/security-scan.yml)

HIVE-ZERO: Hierarchical Multi-Agent Reinforcement Learning system with adversarial swarm intelligence for network security research.

## Architecture

HIVE-ZERO uses a **Sparse Mixture-of-Experts (MoE)** architecture with a learned gating network that dynamically activates the most relevant experts for each observation. The system features **red/blue adversarial co-evolution**: both teams train simultaneously in an arms race, with a persistent Threat Intelligence Database that ensures the swarm continuously adapts — like a threat analyst who never sleeps.

### Expert Clusters (19 Experts)

| Cluster | Experts | Purpose |
|---------|---------|---------|
| **A — Recon** | Cartographer (3-layer GAT), DeepScope (Multi-Head Attn Mask), Chronos (Transformer Temporal) | Network mapping, constraint enforcement, timing |
| **B — Attack** | Sentinel (BERT), PayloadGen (T5), Mutator (Adam Optimiser + Genetic Evolution) | Payload classification, generation, and adversarial optimisation with polymorphic capabilities |
| **C — Post-Exploit** | Mimic (Spectral-Norm GAN), Ghost (Entropy-Gated), Stego (VAE), Cleaner (Residual) | Traffic shaping, hiding, steganography, cleanup |
| **D — Active Defense** | Tarpit (25 traps, Multi-Head Attn Fusion) | Spectral/temporal/chaotic trap arsenal with attention-weighted fusion |
| **E — Kill Chain** | FeedbackLoop (Multi-Scale), Flashbang (Adaptive Burst), GlassHouse (Phase-Modulated) | Counter-strike synergisers auto-activated with Tarpit |
| **F — Blue Team** | WAF (Signature Bank), EDR (Transformer Behavioural), SIEM (Alert Prototype Correlator), IDS (Multi-Scale Conv) | Adversarial detection stack that co-evolves with the red team |
| **G — Red Booster** | PreAttackBooster (Gated Evasion Encoder) | Hardens payloads against the full blue-team stack before delivery |

### Synergy Logic

When the **Tarpit** expert is activated by the gating network, the **Kill Chain** cluster (FeedbackLoop, Flashbang, GlassHouse) is force-enabled to execute a coordinated quad-strike response.

### Adversarial Co-Evolution

The training loop alternates between **red-team** and **blue-team** optimisation steps:

1. **Red step** — Minimises detection probability across WAF + EDR + SIEM + IDS while maximising payload diversity, stealth, and information gain.
2. **Blue step** — Maximises detection probability on payloads generated by the red team this epoch.
3. **Threat Intel evolution** — Successful evasions and caught payloads are recorded into the `ThreatIntelDB`, which maintains separate attack/defence signature banks updated via EMA. Both teams query this database to inform their next decisions.

### Threat Intelligence Database

The `ThreatIntelDB` maintains:
- **Attack Bank** — EMA-updated signature prototypes of payloads that successfully evaded detection (red-team imitation source)
- **Defence Bank** — EMA-updated prototypes of caught payloads (blue-team recognition patterns)
- **Novelty Gate** — Prevents mode collapse by only storing sufficiently novel embeddings
- **Generational Counter** — Tracks co-evolution progress and evasion rate trends

## Project Structure

```
hive_zero_core/
├── __init__.py
├── hive_mind.py              # Master orchestrator with gating network
├── agents/
│   ├── base_expert.py        # Abstract expert base class with gating logic
│   ├── recon_experts.py      # Cartographer, DeepScope, Chronos
│   ├── attack_experts.py     # Sentinel, PayloadGen, Mutator (with genetic evolution)
│   ├── genetic_evolution.py  # Polymorphic engine, natural selection, generation tracking
│   ├── defense_experts.py    # Tarpit with TrapArsenal
│   ├── post_experts.py       # Mimic, Ghost, Stego, Cleaner
│   ├── offensive_defense.py  # FeedbackLoop, Flashbang, GlassHouse
│   ├── blue_team.py          # WAF, EDR, SIEM, IDS
│   └── red_booster.py        # PreAttackBooster
├── memory/
│   ├── foundation.py         # Synthetic experience generator and weight init
│   ├── graph_store.py        # Network log → PyG graph encoder
│   └── threat_intel_db.py    # Evolving threat intelligence database
├── training/
│   ├── adversarial_loop.py   # Red/blue adversarial co-evolution training loop
│   ├── config.py             # Experiment configuration management
│   ├── data_loader.py        # Dataset and data loading utilities
│   └── rewards.py            # Composite reward (R_adv + R_info + R_stealth + R_temporal)
└── utils/
    └── logging_config.py     # Logging configuration
```

## Requirements

- Python ≥ 3.10
- PyTorch ≥ 2.6
- PyTorch Geometric ≥ 2.3
- Transformers ≥ 4.48
- See `requirements.txt` for full list

## Installation

### Quick Start

```bash
# Clone the repository
git clone https://github.com/DonHin-00/Adversarial-Swarm.git
cd Adversarial-Swarm

# Install dependencies
pip install -r requirements.txt

# Install the package
pip install -e .
```

### Development Setup

```bash
# Install with development dependencies
pip install -e ".[dev]"

# Install pre-commit hooks
make pre-commit

# Or manually:
pip install pre-commit
pre-commit install
```

### Using Make

```bash
# See all available commands
make help

# Common commands:
make install        # Install production dependencies
make install-dev    # Install development dependencies
make test          # Run tests
make lint          # Run linters
make format        # Format code
make clean         # Clean build artifacts
```

### Docker Setup

```bash
# Build the Docker image
make docker-build

# Or manually:
docker-compose build

# Run the container
docker-compose up -d

# For development:
docker-compose run dev bash
```

## Usage

```python
from hive_zero_core.hive_mind import HiveMind

# Initialize with pretrained knowledge bootstrap
hive = HiveMind(observation_dim=64, pretrained=True)

# Process network logs
logs = [
    {"src_ip": "192.168.1.1", "dst_ip": "10.0.0.5", "port": 80, "proto": 6},
    {"src_ip": "10.0.0.5", "dst_ip": "8.8.8.8", "port": 53, "proto": 17},
]
results = hive.forward(logs, top_k=5)

# Drive co-evolution after each forward pass
hive.evolve_threat_intel(results)

# Inspect threat intelligence state
stats = hive.threat_intel.get_stats()
print(f"Generation {stats['generation']}, Evasion rate: {stats['avg_evasion_rate']:.1%}")
```

### Genetic Evolution for Red Team

Use polymorphic capabilities to evolve attack payloads:

```python
from hive_zero_core.agents.genetic_evolution import GeneticEvolution

# Initialize evolution engine
evolution = GeneticEvolution()

# Evolve a payload through generations
payload = "' OR '1'='1"
mutated, gene_seed, success = evolution.evolve_payload(payload)

# Evolve Python exploit code
exploit_code = """
def exploit():
    # attack logic
    pass
"""
mutated_code, gene_seed, success = evolution.evolve_code(exploit_code)

# Get evolution statistics
stats = evolution.get_stats()
print(f"Success rate: {stats['success_rate']:.1%}")
```

For more details, see [Genetic Evolution Guide](docs/GENETIC_EVOLUTION.md) and run the demo:

```bash
python scripts/demo_genetic_evolution.py
```

### Training the System

Train the HiveMind using adversarial learning:

```python
from hive_zero_core.training.adversarial_loop import train_hive_mind_adversarial
from hive_zero_core.training import get_quick_test_config

# Red/blue adversarial co-evolution with ThreatIntelDB
train_hive_mind_adversarial(num_epochs=100)

# Or use a quick test config
config = get_quick_test_config()
trained_hive = train_hive_mind_adversarial(config=config)
```

For detailed training instructions, see [Training Guide](docs/TRAINING_GUIDE.md).

## Development

### Running Tests

```bash
# Run all tests
pytest

# Run specific test files
pytest tests/test_config.py
pytest tests/test_experts.py

# Run with coverage
pytest --cov=hive_zero_core --cov-report=html

# Or using make
make test
```

The test suite includes:
- **90+ tests** covering configuration, data loading, rewards, and expert implementations
- Tests designed to work in sandboxed environments (no network access required)
- Comprehensive coverage of training infrastructure

### Code Quality

```bash
# Run all linters
make lint

# Format code
make format

# Individual tools
flake8 hive_zero_core
pylint hive_zero_core
black hive_zero_core
isort hive_zero_core
mypy hive_zero_core
```

## CI/CD

The project includes comprehensive CI/CD pipelines:

- **Python CI**: Automated testing, linting, and code quality checks
- **Security Scan**: CodeQL and Semgrep security analysis
- **Dependency Management**: Automated dependency updates via Dependabot

## Contributing

See [CONTRIBUTING.md](CONTRIBUTING.md) for detailed contribution guidelines.

1. Fork the repository
2. Create a feature branch (`git checkout -b feature/amazing-feature`)
3. Commit your changes (`git commit -m 'Add amazing feature'`)
4. Push to the branch (`git push origin feature/amazing-feature`)
5. Open a Pull Request

## Documentation

- [Training Guide](docs/TRAINING_GUIDE.md) - Comprehensive guide to training the system
- [Contributing Guidelines](CONTRIBUTING.md) - How to contribute to the project
- [Changelog](CHANGELOG.md) - Project history and updates

## License

MIT License - See LICENSE file for details

## Acknowledgments

Built with PyTorch, PyTorch Geometric, and other excellent open-source tools.
